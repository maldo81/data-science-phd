---
title: "Cleaning your Data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Already complete Code

As we move on from week to week and task to task, the code that you have already completed, will stay on the template but will not run, this is possible by adding eval=FALSE to the corresponding code chunk.
Note that the libraries need to be linked to this program as well.


```{r install}

# Install and load necessary libraries
#install.packages("ggplot2") # Install ggplot2 for plotting, if you have already installed the packages, comment this out by enterring a # in front of this command
#install.packages("scales")  # Install scales for formatting
#install.packages("moments") # Install moments for skewness and kurtosis
library(ggplot2)            # Load ggplot2 library
library(scales)             # Load scales library


```


## Setting up your directory in your computer.

This needs to be addressed here.



```{r Dir}
# Check the current working directory
getwd()

# in the next line, change the directory to the place where you saved the
# data file, if you prefer you can save your data.csv file in the directory
# that command 7 indicated.
# for example your next line should like something similar to this: setwd("C:/Users/tsapara/Documents")

# Set the working directory to where the data file is located
# This ensures the program can access the file correctly

setwd("C:/Users/ITsapara/Downloads")

### Choose an already existing directory in your computer.
```

## Setting up your personalized data

```{r Read, eval=FALSE}
# Read the CSV file
# The header parameter ensures column names are correctly read
# sep defines the delimiter (comma in this case)
# stringsAsFactors prevents automatic conversion of strings to factors
df <- read.csv("data.csv", header = TRUE, sep = ",", stringsAsFactors = TRUE)

##########################################################
# Define variables A and B based on your student ID
# A represents the first 3 digits, B represents the last 3 digits
A <- 34
B <- 99
Randomizer <- A + B # Randomizer ensures a consistent seed value for reproducibility


# Generate a random sample of 500 rows from the dataset
set.seed(Randomizer) # Set the seed for reproducibility
sample_size <- 500
df <- df[sample(nrow(df), sample_size, replace = TRUE), ] # Sample the dataset

write.csv(df, file = "my_data.csv", row.names = FALSE) # this command may take some time to run once it is done, it will create the desired data file locally in your directory


```


## Knit your file

As practice, you may want now to knit your file in an html. To do this, you should click on the knit button on the top panel, and wait for the rendering file. The HTML will open once it is done for you to review.

It is recommended to practice with RMD and download and review the following cheatsheets: https://rmarkdown.rstudio.com/lesson-15.HTML

In addition, you may want to alter some of the editor components and re-knit your file to gain some knowledge and understanding of RMD.
For a complete tutorial, visit: https://rmarkdown.rstudio.com/lesson-2.html


```{r ReadYourFile}

df <- read.csv("my_data.csv", header = TRUE, sep = ",", stringsAsFactors = TRUE)
```


## Cleaning up your data


***Step 0. Now that you read  the file, you want to learn few information about your data***

The following commands will not be explained here, do your research, review your csv file and answer the questions related with this part of your code.


```{r Explore}

# Basic exploratory commands
nrow(df)       # Number of rows in the dataset
length(df)     # Number of columns (or variables) in the dataset
str(df)        # Structure of the dataset (data types and a preview)
summary(df)    # Summary statistics for each column

```


## Your Turn

Please answer the following questions, by typing information after the question.

***Question 1***

**What type of variables does your file include?**

***Answer 1:***



***Question 2***

**Specific data types?**

***Answer 2:***




***Question 3***

**Are they read properly?**

***Answer 3:***



***Question 4***

**Are there any issues ?**

***Answer 4:***



***Question 5***

**Does your file includes both NAs and blanks?**

***Answer 5:***



***Question 6***

**How many NAs do you have and **

***Answer 6:***



***Question 7***

**How many blanks? **

***Answer 7:***




## Cleanup Continued

***Step 1:  Handling both blanks and NAs is not simple so first we want to eliminate some of those, let's eliminate the blanks and change them to NAs***


```{r Cleanup}


#
# Step 1:  # Handling both blanks and NAs is not simple so first we want to eliminate
# some of those, let's eliminate the blanks and change them to NAs
#


# Replace blanks with NAs across the dataset
# This ensures that blank values are consistently treated as missing data
df[df == ""] <- NA

# Convert specific columns to factors
# This step ensures categorical variables are treated correctly after replacing blanks
factor_columns <- c("Gender", "Education", "Rating", "MaritalStatus", "Category", 
                    "Employment", "Color", "Hobby", "Location")
df[factor_columns] <- lapply(df[factor_columns], function(col) as.factor(as.character(col)))

```


## Cleanup Continued

***Step 2: Count NAs in the entire dataset***


```{r CheackNAs}


#
# Step 2: Count NAs in the entire dataset


# Count the total number of NAs in the dataset
total_nas <- sum(is.na(df))
total_nas # Print the total number of missing values

```

## Your Turn

Please answer the following questions, by typing information after the question.

***Question 8***

**Explain what the printed number is, what is the information that relays and how can you use it in your analysis?**

***Answer 8:***





## Clean Up Continued

***Step 3: Count rows with NAs.***


```{r NARows }

#
# Step 3: Count rows with NAs
#

# Count rows with at least one NA
rows_with_nas <- sum(rowSums(is.na(df)) > 0)
Percent_row_NA <- percent(rows_with_nas / nrow(df)) # Percentage of rows with NAs
rows_with_nas
Percent_row_NA

```

## Your Turn

***Question 9***

**How large is the proportion of the rows with NAs, we can drop up to 5%?**

***Answer 9:***



***Question 10***

**Do you think that would be wise to drop the above percent? **

***Answer 10:***



***Question 11***

**How this will affect your dataset? **

***Answer 11:***




## CleanUp Continued

***Step 4: Count columns with NAs***


```{r NAColumns}



#  
# Step 4: Count columns with NAs

# Count columns with at least one NA
cols_with_nas <- sum(colSums(is.na(df)) > 0)
Percent_col_NA <- percent(cols_with_nas / length(df)) # Percentage of columns with NAs
cols_with_nas
Percent_col_NA

```

## Your Turn

***Question 12***

**How large is the proportion of the cols with NAs, we never want to drop entire columnes as this would mean that we will loose variables and associations but do you think that would be wise to drop the above percent?**

***Answer 12:***



***Question 13***

**How this will affect your dataset? **

***Answer 13:***





## Imputation

***Step 5: Replace NAs with appropriate values (mean for numeric and integer,mode for factor, "NA" for character)***

In later weeks we will learn how to replace the NAs properly based on the descriptive statistics and you will discuss this code.For now, you can assume that by setting the mean of the variable for numeric and mode for categorical it is correct - this is not always the case of course but the code will become much more complicated in that case.


```{r Imputation}


# 
# Step 5: Replace NAs with appropriate values (mean for numeric and integer,
# mode for factor, "NA" for character)
# In later weeks we will learn how to replace the NAs properly based on the
# descriptive statistics and you will discuss this code.
# for now, you can assume that by setting the mean of the variable for numeric
# and mode for categorical it is correct - this is not always the case of course
# but the code will become much more complicated in that case.


# Replace NAs with appropriate values
# Numeric: Replace with the mean if sufficient data is available
# Categorical: Replace with the mode (most common value)
# Character: Replace with the string "NA"
df <- lapply(df, function(col) {
  if (is.numeric(col) || is.integer(col)) { # Numeric or integer columns
    if (sum(!is.na(col)) > 10) {
      col[is.na(col)] <- mean(col, na.rm = TRUE) # Replace with mean
    } else {
      col[is.na(col)] <- approx(seq_along(col), col, n = length(col))[["y"]][is.na(col)] # Interpolation
    }
  } else if (is.factor(col)) { # Factor columns
    mode_val <- names(sort(-table(col)))[1] # Mode (most common value)
    col[is.na(col)] <- mode_val
  } else if (is.character(col)) { # Character columns
    col[is.na(col)] <- "NA" # Replace with "NA"
  }
  return(col) # Return the modified column
})

df <- as.data.frame(df) # Convert the list back to a dataframe


#
# following the above method to impute, has now changed some of the statistics


# Check the updated dataset and ensure no remaining NAs
summary(df)

```


## Your Turn

**Essay Question**

Run summary(df) and compare with the previous statistics. Do you observe any undesired changes? Explain in detail. Are there any more NA's in your file?What is the information that is printed by the summary? How can this be interpreted? what are your observations? Verify the effects of imputation, and explain in detail. Compare the updated summary with the earlier statistics and note changes. Explain everything that you obsevrve.

**Answer**
